Return-path: <m.t.j.spaan@tudelft.nl>
Envelope-to: arc@cassandra.org
Delivery-date: Fri, 03 Mar 2017 04:00:22 -0600
Received: from mailservice.tudelft.nl ([130.161.131.5]:36522)
	by gator3081.hostgator.com with esmtp (Exim 4.87)
	(envelope-from <m.t.j.spaan@tudelft.nl>)
	id 1cjk0Z-0004P2-UE
	for arc@cassandra.org; Fri, 03 Mar 2017 04:00:22 -0600
Received: from localhost (localhost [127.0.0.1])
	by amavis (Postfix) with ESMTP id 7863D2400D7
	for <arc@cassandra.org>; Fri,  3 Mar 2017 11:00:08 +0100 (CET)
X-Virus-Scanned: amavisd-new at tudelft.nl
X-Spam-Flag: NO
X-Spam-Score: -9.751
X-Spam-Level:
X-Spam-Status: No, score=-9.751 tagged_above=-99 required=5
	tests=[HELO_MISC_IP=0.249, RCVD_IN_PBL=10, TUD_REL01=-20]
	autolearn=ham
Received: from mailservice.tudelft.nl ([130.161.131.71])
	by localhost (tudelft.nl [127.0.0.1]) (amavisd-new, port 10026)
	with ESMTP id PB9r-IqDzotP; Fri,  3 Mar 2017 11:00:05 +0100 (CET)
Received: from smtp-a.tudelft.nl (smtp-a.tudelft.nl [131.180.190.158])
	by mx4.tudelft.nl (Postfix) with ESMTP id 1094D2400D5;
	Fri,  3 Mar 2017 11:00:04 +0100 (CET)
Received: from [192.168.2.12] (ip4da1f29d.direct-adsl.nl [77.161.242.157])
	(using TLSv1 with cipher DHE-RSA-AES128-SHA (128/128 bits))
	(No client certificate requested)
	by smtp-a.tudelft.nl (Postfix) with ESMTP id 9AD6D1A406B;
	Fri,  3 Mar 2017 11:00:04 +0100 (CET)
To: Anthony Cassandra <arc@cassandra.org>
Cc: Erwin Walraven <E.M.P.Walraven@tudelft.nl>
From: Matthijs Spaan <m.t.j.spaan@tudelft.nl>
Subject: [pomdp-solve] vector pruning patch
Message-ID: <77a29703-128b-68c2-4379-1372264327d5@tudelft.nl>
Date: Fri, 3 Mar 2017 11:00:04 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101
 Icedove/45.6.0
MIME-Version: 1.0
Content-Type: multipart/mixed;
 boundary="------------E945A616EC422C18F9D3A4C5"
X-Spam-Status: No, score=0.7
X-Spam-Score: 7
X-Spam-Bar: /
X-Spam-Flag: NO

This is a multi-part message in MIME format.
--------------E945A616EC422C18F9D3A4C5
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Dear Tony,

How are you doing? Recently we have been working on vector pruning 
algorithms for incremental pruning. We've released some Java code 
(http://erwinwalraven.nl/solvepomdp), but it would be great if it could 
become part of pomdp-solve as well!

To give you some more detail, we designed an alternative method to 
replace the linear program that is used to detect vector dominance. 
Rather than solving the entire LP directly, we derived a constraint 
generation scheme which incrementally adds a subset of the constraints 
until the optimal LP solution is found. It turns out that only a small 
subset of the constraints is required before reaching the optimal LP 
solution, which creates a significant speedup in several domains. A 
description of the method can be found in our AAAI-17 paper 
(http://www.erwinwalraven.nl/publications/accelerated-vector-pruning-for-optimal-pomdp-solvers.pdf).

We added our new technique to pomdp-solve by integrating the technique 
in the lp-interface.c file (among others). The current version of 
pomdp-solve translates each LP into a lp-solve datastructure. In our new 
version we initialize only one constraint, and the remaining constraints 
are iteratively added during solving. We added two additional parameters 
to pomdp-solve:

-disable_lp_rowgen: if true, then the constraint generation scheme is 
disabled (the technique is activated by default)
-lp_rowgen_threshold: if the size of an LP is below the threshold, then 
it does not apply constraint generation (default value: 50)

A patch which includes all the changes can be found in the attachment, 
which was created using git diff.

Let us know if you have any questions.

Cheers,
Matthijs

--------------E945A616EC422C18F9D3A4C5
Content-Type: text/plain; charset=UTF-8;
 name="lp_rowgen_patch.txt"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="lp_rowgen_patch.txt"

ZGlmZiAtLWdpdCBhL3NyYy9scC1pbnRlcmZhY2UuYyBiL3NyYy9scC1pbnRlcmZhY2UuYwpp
bmRleCA1ZGQzOWRkLi5kN2U3MTM2IDEwMDY0NAotLS0gYS9zcmMvbHAtaW50ZXJmYWNlLmMK
KysrIGIvc3JjL2xwLWludGVyZmFjZS5jCkBAIC0xMDksNiArMTA5LDkgQEAgZXh0ZXJuIGlu
dCBnU2hvd0luc3RhYmlsaXR5TWVzc2FnZXM7CiAgICBjYW4gYmUgc2V0IGFuZCBxdWVyaWVk
LiAgKi8KIGRvdWJsZSBnTHBFcHNpbG9uID0gLTEuMDsKIAoraW50IHJvd0dlbkVuYWJsZWQg
PSAxOworaW50IHJvd0dlblRocmVzaG9sZCA9IDUwOworCiAvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8K
IHZvaWQgCiBMUF9zZXRQcmVjaXNpb24oIGRvdWJsZSBlcHNpbG9uICkgCkBAIC0yNTksNyAr
MjYyLDggQEAgaW5pdExwSW50ZXJmYWNlKCBQb21kcFNvbHZlUGFyYW1zIHBhcmFtICkKICAg
ICAgdG8gc2hvdyBtZXNzYWdlcyBhYm91dCBudW1lcmljYWxseSB1bnN0YWJsZSBMUHMgb3Ig
anVzdCBrZWVwIGEKICAgICAgY291bnQgb2YgdGhlbS4gKi8KICAgZ1Nob3dJbnN0YWJpbGl0
eU1lc3NhZ2VzID0gU0hPV19JTlNUQUJJTElUWV9NRVNTQUdFUzsKLSAgCisgIHJvd0dlbkVu
YWJsZWQgPSBwYXJhbS0+dXNlX2xwX3Jvd2dlbjsKKyAgcm93R2VuVGhyZXNob2xkID0gcGFy
YW0tPnJvd2dlbl90aHJlc2hvbGQ7CiAgIExQX3NldFByZWNpc2lvbiggcGFyYW0tPmxwX2Vw
c2lsb24gKTsKIAogfSAgLyogaW5pdExwSW50ZXJmYWNlICovCkBAIC01NDEsMjAgKzU0NSw0
NiBAQCBMUF9sb2FkTHBTb2x2ZUxQKCBMUCBscCApCiAgICAgIG1hdHJpeCBvciBzcGFyc2Ug
b3Igbm90LiAgSXQgY29waWVzIENQTEVYIHNwYXJzZSBtYXRyaXggZm9ybWF0CiAgICAgIGlu
dG8gdGhhdCBvZiBscF9zb2x2ZSdzIHNwYXJzZSBmb3JtYXQuICAKICAgKi8KLSAgaW50IGks
IGNvbCwgbHBpOworICBpbnQgaSwgY29sLCBscGksIGNvbnN0cmFpbnRJRCwgdmVjdG9yQ29u
c3RyYWludHMsIG51bVN0YXRlczsKICAgbHByZWMgKmxwX3NvbHZlX2xwOwogICBkb3VibGUg
b2JqX3NpZ24sIHJvd19zaWduOworICBkb3VibGUqIGNvbnN0cmFpbnRFbnRyaWVzOwogCiAg
IEFzc2VydCggbHAgIT0gTlVMTCwgIkxQIGlzIE5VTEwuIiApOwogCisgIHZlY3RvckNvbnN0
cmFpbnRzID0gbHAtPnJvd3MgLSAxOworICBudW1TdGF0ZXMgPSBscC0+Y29scyAtIDE7Cisg
IGxwLT5udW1WZWN0b3JDb25zdHJhaW50cyA9IHZlY3RvckNvbnN0cmFpbnRzOworICBscC0+
bnVtU3RhdGVzID0gbnVtU3RhdGVzOworCisgIC8qIFdlIGNoZWNrIHdoZXRoZXIgd2Ugd2Fu
dCB0byB1c2Ugcm93IGdlbmVyYXRpb24gd2hlbiBzb2x2aW5nIHRoZSBMUCAqLworICBpZih2
ZWN0b3JDb25zdHJhaW50cyA+PSByb3dHZW5UaHJlc2hvbGQgJiYgbHAtPmlzRmluZFJlZ2lv
bkxQICYmIHJvd0dlbkVuYWJsZWQpIHsKKyAgICBscC0+dXNlUm93R2VuID0gMTsKKyAgfQor
ICBlbHNlIHsKKyAgICBscC0+dXNlUm93R2VuID0gMDsKKyAgfQorCiAgIC8qIEZpcnN0IGNy
ZWF0ZSB0aGUgc3RvcmFnZSBhbmQgZGVmYXVsdCB2YWx1ZXMgZm9yIHRoZSBscF9zb2x2ZSBk
YXRhCi0gICAgIHN0cnVjdHVyZS4gTm90ZSB0aGF0IGJlY2F1c2UgbHBfc29sdmUgc3RvcmVz
IHRoZSBvYmplY3RpdmUgcm93IGluCisgICAgIHN0cnVjdHVyZS4gKi8KKworICBpZihscC0+
dXNlUm93R2VuKSB7CisgICAgLyogV2UgYWxsb2NhdGUgc3BhY2UgZm9yIDIgY29uc3RyYWlu
dHMsIHNpbmNlIHdlIGFsc28gbmVlZCB0byBlbmNvZGUgdGhlIG9iamVjdGl2ZSBjb2VmZmlj
aWVudHMuICovCisKKyAgICBscF9zb2x2ZV9scCA9IExQX21ha2VfbHAoIGxwLT5yb3dzIC0g
bHAtPm51bVZlY3RvckNvbnN0cmFpbnRzLCBscC0+Y29scywgCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIChudW1TdGF0ZXMrMSkgKiAyICk7IAorICB9CisgIGVsc2UgeworICAg
IC8qIE5vdGUgdGhhdCBiZWNhdXNlIGxwX3NvbHZlIHN0b3JlcyB0aGUgb2JqZWN0aXZlIHJv
dyBpbgogICAgICB0aGUgbWF0cml4LCB0aGUgbnVtYmVyIG9mIG5vbi16ZXJvIGVudHJpZXMg
aW4gbHBfc29sdmUgaXMgdGhlCiAgICAgIG51bWJlciBvZiBub24temVybyBlbnRyaWVzIGlu
IENQTEVYIHBsdXMgdGhlIG51bWJlciBvZiBvYmplY3RpdmUKICAgICAgY29lZmZpY2VpbnRz
LiAgU2luY2UgQ1BMRVggZG9lc24ndCBzdG9yZSB0aGUgb2JqZWN0aXZlIGZ1bmN0aW9uCiAg
ICAgIHNwYXJzZWx5LCB0aGlzIGlzIGp1c3QgdGhlIG51bWJlciBvZiBjb2x1bW5zLiAqLwot
ICBscF9zb2x2ZV9scCA9IExQX21ha2VfbHAoIGxwLT5yb3dzLCBscC0+Y29scywgCisKKyAg
ICBscF9zb2x2ZV9scCA9IExQX21ha2VfbHAoIGxwLT5yb3dzLCBscC0+Y29scywgCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbHAtPm1hdHNwYWNlICsgbHAtPmNvbHMgICk7Cisg
IH0KKwogCiAgIC8qIGxwX3NvbHZlIG9ubHkgZG9lcyBNSU4uIFRvIGdldCBNQVggaXQgbXVs
dGlwbGllcyB0aGUgb2JqZWN0aXZlCiAgICAgIGNvZWZzIGJ5ICctMScsIHNldHMgY2hfc2du
WzBdID0gVFJVRSBhbmQgbHAtPm1heGltaXNlID0gVFJVRS4KQEAgLTU2NSw2ICs1OTUsOSBA
QCBMUF9sb2FkTHBTb2x2ZUxQKCBMUCBscCApCiAgIGVsc2UgCiAgICAgb2JqX3NpZ24gPSAx
LjA7CiAKKyAgLyogQWxsb2NhdGUgbWVtb3J5IHRvIHN0b3JlIGNvbnN0cmFpbnQgZWxlbWVu
dHMgKi8KKyAgaWYobHAtPnVzZVJvd0dlbikgY29uc3RyYWludEVudHJpZXMgPSAoZG91Ymxl
ICopIFhDQUxMT0ModmVjdG9yQ29uc3RyYWludHMqKG51bVN0YXRlcysyKSwgc2l6ZW9mKGRv
dWJsZSkpOworCiAgIC8qIFRoaXMgY29waWVzIGJvdGggdGhlIG5vbi16ZXJvIG1hdHJpY2Vz
IGFuZCB0aGVpciBjb3JyZXNwb25kaW5nCiAgICAgIHJvdyBudW1iZXJzLiBVbmZvcnR1bmF0
ZWx5LCB0aGUgYmlnIHBhaW4gaGVyZSBpcyB0aGF0IGxwX3NvbHZlCiAgICAgIHNob3ZlcyB0
aGUgb2JqZWN0aXZlIGZ1bmN0aW9uIGNvZWZmaWNpZW50cyBpbnRvIHRoZSBjb2VmZmljaWVu
dApAQCAtNTk5LDYgKzYzMiw4IEBAIExQX2xvYWRMcFNvbHZlTFAoIExQIGxwICkKICAgICAg
ICAgIGkgPCBscC0+bWF0YmVnW2NvbF0gKyBscC0+bWF0Y250W2NvbF07IAogICAgICAgICAg
aSsrICkgIHsKIAorICAgICAgY29uc3RyYWludElEID0gbHAtPm1hdGluZFtpXTsgLy8gdGhp
cyBpbmRleCBzdGFydHMgZnJvbSAwCisKICAgICAgIC8qIFdoZW4gdGhlIExQIGlzIGFsbG9j
YXRlZCwgaXQgc2V0cyB0aGluZ3MgdXAgZm9yIGFsbCA8PSByb3dzLgogICAgICAgICAgSWYg
d2UgaGF2ZSBhID49IHJvdywgd2UgbmVlZCB0byBtdWx0aXBseSB0aGUgY29lZiBieSAnLTEn
LgogICAgICAgICAgVGhlIGxwcmVjIHN0cnVjdCBoYXMgY2hfc2lnbltdIHRvIGFpZCB3aXRo
IHRoaXMsIGJ1dCB3ZQpAQCAtNjExLDkgKzY0NiwxNiBAQCBMUF9sb2FkTHBTb2x2ZUxQKCBM
UCBscCApCiAgICAgLyogTm90ZSB0aGF0IGxwX3NvbHZlIGNhcHR1cmVzIGluIG9uZSBhcnJh
eSBvZiBzdHJ1Y3RzIHRoZSBzYW1lCiAgICAgICAgdGhpbmcgQ1BMRVggdXNlcyB0d28gYXJy
YXlzIGZvci4gIE5vIGJpZyBkZWFsIG90aGVyIHRoYW4KICAgICAgICByZW1lbWJlcmluZyB0
aGUgZXh0cmEgbGV2ZWwgb2YgaW5kaXJlY3Rpb24gbmVlZGVkIGZvciBscF9zb2x2ZS4gICov
Ci0gICAgICBscF9zb2x2ZV9scC0+bWF0W2xwaV0udmFsdWUgPSByb3dfc2lnbiAqIGxwLT5t
YXR2YWxbaV07Ci0gICAgICBscF9zb2x2ZV9scC0+bWF0W2xwaV0ucm93X25yID0gbHAtPm1h
dGluZFtpXSArIDE7Ci0gICAgICBscGkrKzsKKyAgICAgIGlmKCFscC0+dXNlUm93R2VuIHx8
IGNvbnN0cmFpbnRJRCA9PSAwKXsKKyAgICAgICAgbHBfc29sdmVfbHAtPm1hdFtscGldLnZh
bHVlID0gcm93X3NpZ24gKiBscC0+bWF0dmFsW2ldOworICAgICAgICBscF9zb2x2ZV9scC0+
bWF0W2xwaV0ucm93X25yID0gbHAtPm1hdGluZFtpXSArIDE7CisgICAgICAgIGxwaSsrOwor
ICAgICAgfQorCisgICAgICAvKiBXZSB1c2UgdGhlIHZlY3RvciBjb25zdHJhaW50IGVudHJp
ZXMgdG8gaW5pdGlhbGl6ZSBhIGNvbnN0cmFpbnRFbnRyaWVzIGFycmF5ICovCisgICAgICBp
ZihscC0+dXNlUm93R2VuICYmIGNvbCA8PSBudW1TdGF0ZXMgJiYgY29uc3RyYWludElEID49
IDEpIHsKKyAgICAgICAgY29uc3RyYWludEVudHJpZXNbKGNvbnN0cmFpbnRJRC0xKSoobnVt
U3RhdGVzKzIpICsgY29sICsgMV0gPSByb3dfc2lnbiAqIGxwLT5tYXR2YWxbaV07CisgICAg
ICB9CiAKICAgICB9IC8qIGZvciBpICovCiAKQEAgLTY0NywxOCArNjg5LDM3IEBAIExQX2xv
YWRMcFNvbHZlTFAoIExQIGxwICkKICAgICAgbGFzdCBscC0+Y29scyBhcmUgdGhlIG9uZXMg
Zm9yIHRoZSB2YXJpYWJsZXMuIFRoZXJlJyBhbHNvIHRoZQogICAgICBvZmYtYnktb25lIHBy
b2JsZW0gdG8gZGVhbCB3aXRoIGhlcmUuICovCiAgIGZvciggaSA9IDA7IGkgPCBscC0+Y29s
czsgaSsrKSB7Ci0gICAgbHBfc29sdmVfbHAtPm9yaWdfdXBib1tscC0+cm93cyArIGkgKyAx
XSA9IGxwLT51cGJuZFtpXTsKLSAgICBscF9zb2x2ZV9scC0+b3JpZ19sb3dib1tscC0+cm93
cyArIGkgKyAxXSA9IGxwLT5sb3dibmRbaV07CisgICAgaWYobHAtPnVzZVJvd0dlbikgewor
ICAgICAgLyogc3VidHJhY3QgdmVjdG9yQ29uc3RyYWludHMgaW4gb3JkZXIgdG8gaW5pdGlh
bGl6ZSB0aGUgdXBwZXIgYW5kIGxvd2VyIGJvdW5kcyBjb3JyZWN0bHkgKi8KKyAgICAgIGxw
X3NvbHZlX2xwLT5vcmlnX3VwYm9bbHAtPnJvd3MgKyBpICsgMSAtIHZlY3RvckNvbnN0cmFp
bnRzXSA9IGxwLT51cGJuZFtpXTsKKyAgICAgIGxwX3NvbHZlX2xwLT5vcmlnX2xvd2JvW2xw
LT5yb3dzICsgaSArIDEgLSB2ZWN0b3JDb25zdHJhaW50c10gPSBscC0+bG93Ym5kW2ldOwor
ICAgIH0KKyAgICBlbHNlIHsKKyAgICAgIGxwX3NvbHZlX2xwLT5vcmlnX3VwYm9bbHAtPnJv
d3MgKyBpICsgMV0gPSBscC0+dXBibmRbaV07CisgICAgICBscF9zb2x2ZV9scC0+b3JpZ19s
b3dib1tscC0+cm93cyArIGkgKyAxXSA9IGxwLT5sb3dibmRbaV07CisgICAgfQorCiAgIH0g
LyogZm9yIGkgKi8KIAogICAvKiBUaGUgcmlnaHQgaGFuZCBzaWRlcyBqdXN0IGhhdmUgdG8g
YWNjb3VudCBmb3IgdGhlIG9mZi1ieS1vbmUKICAgICAgaW5kZXhpbmcgcHJvYmxlbS4gQWxz
bywgc2luY2Ugd2UgYXJlIGRvaW5nIHRoZSBtdWx0aXBsaWNhdGlvbiBieQogICAgICAnLTEn
IGZvciA+PSByb3dzLCBtYWtlIHN1cmUgd2UgZG8gdGhpcyBmb3IgdGhlIFJIUy4gKi8KLSAg
Zm9yICggaSA9IDA7IGkgPCBscC0+cm93czsgaSsrICkKLSAgICBpZiAoIGxwLT5zZW5zZVtp
XSA9PSAnRycgKQotICAgICAgbHBfc29sdmVfbHAtPm9yaWdfcmhbaSsxXSA9IC0xLjAgKiBs
cC0+cmhzW2ldOwotICAgIGVsc2UKLSAgICAgIGxwX3NvbHZlX2xwLT5vcmlnX3JoW2krMV0g
PSBscC0+cmhzW2ldOworCisgIGlmKGxwLT51c2VSb3dHZW4pIHsKKyAgICBmb3IgKCBpID0g
MDsgaSA8IGxwLT5yb3dzIC0gdmVjdG9yQ29uc3RyYWludHM7IGkrKyApCisgICAgICBpZiAo
IGxwLT5zZW5zZVtpXSA9PSAnRycgKQorICAgICAgICBscF9zb2x2ZV9scC0+b3JpZ19yaFtp
KzFdID0gLTEuMCAqIGxwLT5yaHNbaV07CisgICAgICBlbHNlCisgICAgICAgIGxwX3NvbHZl
X2xwLT5vcmlnX3JoW2krMV0gPSBscC0+cmhzW2ldOworICB9CisgIGVsc2UgeworICAgIGZv
ciAoIGkgPSAwOyBpIDwgbHAtPnJvd3M7IGkrKyApCisgICAgICBpZiAoIGxwLT5zZW5zZVtp
XSA9PSAnRycgKQorICAgICAgICBscF9zb2x2ZV9scC0+b3JpZ19yaFtpKzFdID0gLTEuMCAq
IGxwLT5yaHNbaV07CisgICAgICBlbHNlCisgICAgICAgIGxwX3NvbHZlX2xwLT5vcmlnX3Jo
W2krMV0gPSBscC0+cmhzW2ldOworICB9CisKIAogICAvKiBUaGUgc2Vuc2Ugb2YgdGhlIGNv
bnN0cmFpbnQgcm93IGlzIGZhaXJseSBleHBsaWNpdCBpbiBDUExFWCwgYnV0CiAgICAgIG1v
cmUgc3VidGxlIGluIGxwX3NvbHZlLiBscF9zb2x2ZSByZWFsbHkgb25seSBhbGxvd3MgPD0K
QEAgLTY3Miw5ICs3MzMsMTggQEAgTFBfbG9hZExwU29sdmVMUCggTFAgbHAgKQogICAgICB2
YWx1ZXMgaGF2ZSBiZWVuIGFscmVhZHkgc2V0LCB3ZSBwcmVmZXIgdG8gYWRqdXN0ID49IHJv
dyB0byA8PSBieQogICAgICBvdXJzZWx2ZXMgYXMgd2FzIGRvbmUgYWJvdmUuICBIb3dldmVy
LCB3ZSBkbyBzdGlsbCBuZWVkIHRvIHNldAogICAgICB0aGUgdXBwZXIgYm91bmQgb24gdGhl
IGVxdWFsaXR5IHJvd3MuICovCi0gIGZvciAoIGkgPSAwOyBpIDwgbHAtPnJvd3M7IGkrKyAp
Ci0gICAgaWYgKCBscC0+c2Vuc2VbaV0gPT0gJ0UnICkKLSAgICAgIGxwX3NvbHZlX2xwLT5v
cmlnX3VwYm9baSsxXSA9IDAuMDsKKworICBpZihscC0+dXNlUm93R2VuKSB7CisgICAgZm9y
ICggaSA9IDA7IGkgPCBscC0+cm93cyAtIHZlY3RvckNvbnN0cmFpbnRzOyBpKysgKQorICAg
ICAgaWYgKCBscC0+c2Vuc2VbaV0gPT0gJ0UnICkKKyAgICAgICAgbHBfc29sdmVfbHAtPm9y
aWdfdXBib1tpKzFdID0gMC4wOworICB9CisgIGVsc2UgeworICAgIGZvciAoIGkgPSAwOyBp
IDwgbHAtPnJvd3M7IGkrKyApCisgICAgICBpZiAoIGxwLT5zZW5zZVtpXSA9PSAnRScgKQor
ICAgICAgICBscF9zb2x2ZV9scC0+b3JpZ191cGJvW2krMV0gPSAwLjA7CisgIH0KKwogICAK
ICAgLyogQXMgZmFyIGFzIEkgY2FuIHRlbGwsIHRoZSBscF9zb2x2ZSBmaWVsZHM6CiAKQEAg
LTY5Miw2ICs3NjIsMTEgQEAgTFBfbG9hZExwU29sdmVMUCggTFAgbHAgKQogICAgICBmaWxl
LCBzbyBJIHN1c3BlY3R0aGlzIGFzc3VtcHRpb24gaXMgbGlrZWx5IHRvIGJlIHJpZ2h0Lgog
ICAqLwogCisgIGlmKGxwLT51c2VSb3dHZW4pIHsKKyAgICBscC0+cm93cyA9IDE7CisgICAg
bHAtPmNvbnN0cmFpbnRFbnRyaWVzID0gY29uc3RyYWludEVudHJpZXM7CisgIH0KKwogICBy
ZXR1cm4gKCBscF9zb2x2ZV9scCApOwogfSAgLyogTFBfbG9hZExwU29sdmVMUCAqLyAKIC8q
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqLwpAQCAtOTQ3LDI3ICsxMDIyLDExNyBAQCBMUF9vcHRpbWl6ZUxQ
KCBMUCBscCApCiAgICAgbHBfc29sdmUgd2lsbCB1c2UgdGhlIHNhbWUgb3B0aW1pemF0aW9u
IHJvdXRpbmUgcmVnYXJkbGVzcyBvZiB0aGUKICAgICBhbGdvcml0aG0uIAogICAqLwotICBp
bnQgc3RhdHVzOwotCi0gIHN3aXRjaCggbHAtPmxwX2FsZ29yaXRobSApIHsKLSAgICAKLSAg
Y2FzZSBkdWFsX3NpbXBsZXg6Ci0jaWZkZWYgSEFWRV9MSUJDUExFWAotICAgIHN0YXR1cyA9
IGR1YWxvcHQoIGxwLT5scCApOwotI2Vsc2UKLSAgICBzdGF0dXMgPSBzb2x2ZSggbHAtPmxw
ICk7Ci0jZW5kaWYKLSAgICBicmVhazsKKyAgaW50IHN0YXR1cywgaSwgaiwgaXRlciwgZWxl
bWVudEluZGV4LCBvcmlnUm93cywgb3JpZ0NvbHMsIGJlc3RSb3c7CisgIGRvdWJsZSAqYmVs
aWVmLCAqbmV3QmVsaWVmOworICBkb3VibGUgY3VyclJvd1ZhbCwgYmVzdFJvd1ZhbCwgYmVs
aWVmRGlmZiwgYmVsaWVmU3VtOworICBpbnQqIGNvbnN0cmFpbnRzQWRkZWQ7CisKKyAgaWYo
bHAtPnVzZVJvd0dlbikgeworICAgIC8qIFRoaXMgcGFydCBvZiB0aGUgY29kZSBpbXBsZW1l
bnRzIGEgcm93IGdlbmVyYXRpb24gbWV0aG9kLCBkZXNjcmliZWQgaW4gdGhlIGZvbGxvd2lu
ZyBwYXBlcjoKKyAgICAgICAKKyAgICAgICBXYWxyYXZlbiwgRS4sICYgU3BhYW4sIE0uIFQu
IEouICgyMDE3KS4gQWNjZWxlcmF0ZWQgVmVjdG9yIFBydW5pbmcgZm9yIE9wdGltYWwgUE9N
RFAgU29sdmVycy4KKyAgICAgICBJbiBQcm9jZWVkaW5ncyBvZiB0aGUgMzFzdCBBQUFJIENv
bmZlcmVuY2Ugb24gQXJ0aWZpY2lhbCBJbnRlbGxpZ2VuY2UuICAgICAgICAqLworCisgICAg
bHByZWMqIGxwc29sdmVscCA9IGxwLT5scDsKKyAgICBvcmlnUm93cyA9IGxwc29sdmVscC0+
cm93czsKKyAgICBvcmlnQ29scyA9IGxwc29sdmVscC0+Y29sdW1uczsKICAgICAKLSAgY2Fz
ZSBwcmltYWxfc2ltcGxleDoKLSAgZGVmYXVsdDoKLSNpZmRlZiBIQVZFX0xJQkNQTEVYCi0g
ICAgc3RhdHVzID0gb3B0aW1pemUoIGxwLT5scCApOwotI2Vsc2UKLSAgICBzdGF0dXMgPSBz
b2x2ZSggbHAtPmxwICk7Ci0jZW5kaWYKLSAgICBicmVhazsKLSAgfSAgLyogc3dpdGNoIGxw
LT5scF9hbGdvcml0aG0gKi8KKyAgICAvLyBzdGFydCByb3cgZ2VuZXJhdGlvbjogZmluZCBi
ZXN0IGluaXRpYWwgdmVjdG9yCisgICAgYmVzdFJvd1ZhbCA9IERFRl9JTkZJTklURTsKKyAg
ICBiZWxpZWYgPSAoZG91YmxlKikgWENBTExPQygoc2l6ZV90KSAobHAtPm51bVN0YXRlcyks
IHNpemVvZihkb3VibGUpKTsKKyAgICBiZWxpZWZbMF0gPSAxLjA7CisgICAgZm9yKGk9MTsg
aTxscC0+bnVtU3RhdGVzOyBpKyspIHsKKyAgICAgIGJlbGllZltpXSA9IDAuMDsKKyAgICB9
CisKKyAgICBmb3IoaT0wOyBpPGxwLT5udW1WZWN0b3JDb25zdHJhaW50czsgaSsrKSB7Cisg
ICAgICBjdXJyUm93VmFsID0gMC4wOworICAgICAgZm9yKGo9MDsgajxscC0+bnVtU3RhdGVz
OyBqKyspIHsKKyAgICAgICAgY3VyclJvd1ZhbCArPSBiZWxpZWZbal0gKiBscC0+Y29uc3Ry
YWludEVudHJpZXNbaSoobHAtPm51bVN0YXRlcysyKSArIGogKyAxXSAqIC0xLjA7CisgICAg
ICB9CisgICAgICBpZihjdXJyUm93VmFsIDwgYmVzdFJvd1ZhbCkgeworICAgICAgICBiZXN0
Um93VmFsID0gY3VyclJvd1ZhbDsKKyAgICAgICAgYmVzdFJvdyA9IGk7CisgICAgICB9Cisg
ICAgfQorCisgICAgLy8gc3RhcnQgaXRlcmF0aW5nCisgICAgaXRlciA9IDA7CisgICAgY29u
c3RyYWludHNBZGRlZCA9IChpbnQqKSBYQ0FMTE9DKChzaXplX3QpIGxwLT5udW1WZWN0b3JD
b25zdHJhaW50cywgc2l6ZW9mKGludCkpOworICAgIHdoaWxlKDEpIHsKKyAgICAgIGl0ZXIr
KzsKKyAgICAgIAorICAgICAgLy8gYWRkIGNvbnN0cmFpbnQKKyAgICAgIGNvbnN0cmFpbnRz
QWRkZWRbYmVzdFJvd10gPSAxOworICAgICAgYWRkX2NvbnN0cmFpbnQobHBzb2x2ZWxwLCAm
bHAtPmNvbnN0cmFpbnRFbnRyaWVzW2Jlc3RSb3cqKGxwLT5udW1TdGF0ZXMrMildLCBMRSwg
MC4wKTsKKyAgICAgIGxwLT5yb3dzID0gbHAtPnJvd3MgKyAxOworCisgICAgICAvLyBzb2x2
ZSB0aGUgbW9kZWwKKyAgICAgIHNvbHZlKGxwc29sdmVscCk7CisKKyAgICAgIC8vIGdldCBz
b2x1dGlvbgorICAgICAgbmV3QmVsaWVmID0gKGRvdWJsZSopIFhDQUxMT0MoKHNpemVfdCkg
bHAtPm51bVN0YXRlcywgc2l6ZW9mKGRvdWJsZSkpOworICAgICAgYmVsaWVmRGlmZiA9IDAu
MDsKKyAgICAgIGJlbGllZlN1bSA9IDAuMDsKKyAgICAgIGZvcihpPTA7IGk8bHAtPm51bVN0
YXRlczsgaSsrKSB7CisgICAgICAgIG5ld0JlbGllZltpXSA9IGxwLT5scC0+YmVzdF9zb2x1
dGlvbltpdGVyKzIraV07CisgICAgICAgIGJlbGllZkRpZmYgKz0gZmFicyhiZWxpZWZbaV0g
LSBuZXdCZWxpZWZbaV0pOworICAgICAgICBiZWxpZWZTdW0gKz0gbmV3QmVsaWVmW2ldOwor
ICAgICAgfQorCisgICAgICAvLyBmcmVlIG1lbW9yeSBhbmQgcmVwbGFjZSB0aGUgYmVsaWVm
IHBvaW50CisgICAgICBmcmVlKGJlbGllZik7CisgICAgICBiZWxpZWYgPSBuZXdCZWxpZWY7
CisKKyAgICAgIC8vIGNoZWNrIGlmIHdlIGNhbiBzdG9wIGdlbmVyYXRpbmcgY29uc3RyYWlu
dHMKKyAgICAgIGlmKGJlbGllZkRpZmYgPD0gUk9XX0dFTkVSQVRJT05fQkVMSUVGX1RPTEVS
QU5DRSB8fCBscC0+bHAtPmJlc3Rfc29sdXRpb25bMF0gPj0gMCB8fCBpdGVyID4gbHAtPm51
bVZlY3RvckNvbnN0cmFpbnRzKSB7CisgICAgICAgIGJyZWFrOworICAgICAgfQorICAgICAg
ZWxzZSB7CisgICAgICAgIC8vIGZpbmQgbmV3IGNvbnN0cmFpbnQgdG8gYWRkIGluIHRoZSBu
ZXh0IGl0ZXJhdGlvbgorICAgICAgICBiZXN0Um93VmFsID0gREVGX0lORklOSVRFOworICAg
ICAgICBmb3IoaT0wOyBpPGxwLT5udW1WZWN0b3JDb25zdHJhaW50czsgaSsrKSB7CisgICAg
ICAgICAgY3VyclJvd1ZhbCA9IDAuMDsKKyAgICAgICAgICBmb3Ioaj0wOyBqPGxwLT5udW1T
dGF0ZXM7IGorKykgeworICAgICAgICAgICAgY3VyclJvd1ZhbCArPSBiZWxpZWZbal0gKiBs
cC0+Y29uc3RyYWludEVudHJpZXNbaSoobHAtPm51bVN0YXRlcysyKSArIGogKyAxXSAqIC0x
LjA7CisgICAgICAgICAgfQorICAgICAgICAgIGlmKGN1cnJSb3dWYWwgPCBiZXN0Um93VmFs
KSB7CisgICAgICAgICAgICBiZXN0Um93VmFsID0gY3VyclJvd1ZhbDsKKyAgICAgICAgICAg
IGJlc3RSb3cgPSBpOworICAgICAgICAgIH0KKyAgICAgICAgfQorCisgICAgICAgIGlmKGNv
bnN0cmFpbnRzQWRkZWRbYmVzdFJvd10pIGJyZWFrOworICAgICAgfQorICAgIH0KKworICAg
IC8vIGl0ZXJhdGlvbnMgYXJlIHJlYWR5LCBzbyB3ZSBjYW4gY2xlYXIgbWVtb3J5CisgICAg
ZnJlZShjb25zdHJhaW50c0FkZGVkKTsKKyAgICBmcmVlKGJlbGllZik7CisgICAgZnJlZShs
cC0+Y29uc3RyYWludEVudHJpZXMpOworCisgIH0KKyAgZWxzZSB7CisgICAgc3dpdGNoKCBs
cC0+bHBfYWxnb3JpdGhtICkgeworICAgICAgCisgICAgY2FzZSBkdWFsX3NpbXBsZXg6Cisg
ICNpZmRlZiBIQVZFX0xJQkNQTEVYCisgICAgICBzdGF0dXMgPSBkdWFsb3B0KCBscC0+bHAg
KTsKKyAgI2Vsc2UKKyAgICAgIHN0YXR1cyA9IHNvbHZlKCBscC0+bHAgKTsKKyAgI2VuZGlm
CisgICAgICBicmVhazsKKyAgICAgIAorICAgIGNhc2UgcHJpbWFsX3NpbXBsZXg6CisgICAg
ZGVmYXVsdDoKKyAgI2lmZGVmIEhBVkVfTElCQ1BMRVgKKyAgICAgIHN0YXR1cyA9IG9wdGlt
aXplKCBscC0+bHAgKTsKKyAgI2Vsc2UKKyAgICAgIHN0YXR1cyA9IHNvbHZlKCBscC0+bHAg
KTsKKyAgI2VuZGlmCisgICAgICBicmVhazsKKyAgICB9ICAvKiBzd2l0Y2ggbHAtPmxwX2Fs
Z29yaXRobSAqLworICB9CiAKICAgLyogV2UnbGwgd3JpdGUgdGhlIHN0YXR1cyBpbnRvIHRo
ZSBMUCBzdHJ1Y3R1cmUuICBOb3RlIHRoYXQgQ1BMRVgKICAgICAgd2lsbCB1c2UgYSBkaWZm
ZXJlbnQgc3RhdHVzIChoZW5jZSwgb3ZlcndyaXRlIHRoaXMpIHdpdGggaXRzCmRpZmYgLS1n
aXQgYS9zcmMvbHAtaW50ZXJmYWNlLmggYi9zcmMvbHAtaW50ZXJmYWNlLmgKaW5kZXggZDli
MThjNi4uMDNiYWIyMCAxMDA2NDQKLS0tIGEvc3JjL2xwLWludGVyZmFjZS5oCisrKyBiL3Ny
Yy9scC1pbnRlcmZhY2UuaApAQCAtMTI2LDYgKzEyNiw4IEBACiAgICAqLwogI2RlZmluZSBT
SE9XX0lOU1RBQklMSVRZX01FU1NBR0VTICAgICBGQUxTRQogCisjZGVmaW5lIFJPV19HRU5F
UkFUSU9OX0JFTElFRl9UT0xFUkFOQ0UgIDFlLTUKKwogLyoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAv
KioqKioqKioqKioqKioqKioqKiogICAgVFlQRURFRlMgICAgICAgICAgICAqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtMTc2LDYgKzE3OCwx
NCBAQCBzdHJ1Y3QgTHBTdHJ1Y3QgewogICBkb3VibGUgICAqbWF0dmFsOyAgICAgICAgICAg
ICAgIC8qIHNpemUgPSBudW0gbm9uLXplcm8gY29lZnMgKi8KICAgZG91YmxlICAgKmxvd2Ju
ZDsgICAgICAgICAgICAgICAvKiBzaXplID0gbnVtIHZhcmlhYmxlcyAoY29scykgKi8KICAg
ZG91YmxlICAgKnVwYm5kOyAgICAgICAgICAgICAgICAvKiBzaXplID0gbnVtIHZhcmlhYmxl
cyAoY29scykgKi8KKworICAvKiBWYXJpYWJsZXMgbmVlZGVkIGZvciByb3cgZ2VuZXJhdGlv
biAqLworICBpbnQgaXNGaW5kUmVnaW9uTFA7ICAgICAgICAgICAgIC8qIGlmIDEsIHRoZW4g
dGhpcyBMUCBpcyBhIGZpbmQgcmVnaW9uIExQICovCisgIGludCB1c2VSb3dHZW47ICAgICAg
ICAgICAgICAgICAgLyogaWYgMSwgdGhlbiB0aGUgc29sdmVyIHNob3VsZCBhcHBseSByb3cg
Z2VuZXJhdGlvbiAqLworICBkb3VibGUqIGNvbnN0cmFpbnRFbnRyaWVzOyAgICAgIC8qIGNv
bnN0cmFpbnQgY29lZmZpY2llbnRzLCB3aGljaCBoYXZlIG5vdCBiZWVuIGFkZGVkIHlldCAq
LworICBpbnQgbnVtVmVjdG9yQ29uc3RyYWludHM7ICAgICAgIC8qIHRvdGFsIG51bWJlciBv
ZiBjb25zdHJhaW50cyByZXByZXNlbnRlZCBieSBjb25zdHJhaW50RW50cmllcyAqLworICBp
bnQgbnVtU3RhdGVzOyAgICAgICAgICAgICAgICAgIC8qIHRvdGFsIG51bWJlciBvZiBzdGF0
ZXMgaW4gdGhlIFBPTURQIHdlIGFyZSBzb2x2aW5nICovCisKICAgCiAjaWZkZWYgSEFWRV9D
UExFWAogICAvKiBUaGluZ3Mgb25seSBuZWVkZWQgZm9yIENQTEVYLiAqLwpkaWZmIC0tZ2l0
IGEvc3JjL3BhcmFtcy5jIGIvc3JjL3BhcmFtcy5jCmluZGV4IDQ4MzI5YjYuLmI3OWFjNTkg
MTAwNjQ0Ci0tLSBhL3NyYy9wYXJhbXMuYworKysgYi9zcmMvcGFyYW1zLmMKQEAgLTEyNCw2
ICsxMjQsOCBAQCBuZXdQb21kcFNvbHZlUGFyYW1zKCAgKQogICBwYXJhbXMtPmRvbWluYXRp
b25fY2hlY2sgPSBERUZBVUxUX0RPTUlOQVRJT05fQ0hFQ0s7CiAgIHBhcmFtcy0+YWxnX2lu
aXRfcmFuZF9wb2ludHMgPSBERUZBVUxUX0FMR19JTklUX1JBTkRfUE9JTlRTOwogICBwYXJh
bXMtPnBydW5lX2luaXRfcmFuZF9wb2ludHMgPSBERUZBVUxUX1BSVU5FX0lOSVRfUkFORF9Q
T0lOVFM7CisgIHBhcmFtcy0+dXNlX2xwX3Jvd2dlbiA9IERFRkFVTFRfVVNFX1JPV0dFTjsK
KyAgcGFyYW1zLT5yb3dnZW5fdGhyZXNob2xkID0gREVGQVVMVF9ST1dHRU5fVEhSRVNIT0xE
OwogCiAgIHBhcmFtcy0+cHJ1bmVfZXBzaWxvbiA9IERFRkFVTFRfUFJVTkVfRVBTSUxPTjsg
CiAgIHBhcmFtcy0+ZXBzaWxvbiA9IERFRkFVTFRfRVBTSUxPTjsgCkBAIC0zODAsNiArMzgy
LDggQEAgdGVtcE9wdHNUb1BhcmFtQ29udmVyc2lvbiggUG9tZHBTb2x2ZVBhcmFtcyBwYXJh
bXMgKSB7CiAgIHBhcmFtcy0+bWF4X3NvbG5fc2l6ZSA9IG9wdHMtPm1heF9zb2xuX3NpemU7
CiAgIHBhcmFtcy0+ZXBvY2hfaGlzdG9yeV93aW5kb3dfbGVuZ3RoID0gb3B0cy0+ZXBvY2hf
aGlzdG9yeV93aW5kb3dfbGVuZ3RoOwogICBwYXJhbXMtPmVwb2NoX2hpc3Rvcnlfd2luZG93
X2RlbHRhID0gb3B0cy0+ZXBvY2hfaGlzdG9yeV93aW5kb3dfZGVsdGE7CisgIHBhcmFtcy0+
dXNlX2xwX3Jvd2dlbiA9IDEtb3B0cy0+ZGlzYWJsZV9scF9yb3dnZW47CisgIHBhcmFtcy0+
cm93Z2VuX3RocmVzaG9sZCA9IG9wdHMtPnJvd2dlbl90aHJlc2hvbGQ7CiAKICAgc3dpdGNo
KCBvcHRzLT5pcF90eXBlICkKICAgICB7CmRpZmYgLS1naXQgYS9zcmMvcGFyYW1zLmggYi9z
cmMvcGFyYW1zLmgKaW5kZXggNzFjYmZmZi4uZjM3ODYyZSAxMDA2NDQKLS0tIGEvc3JjL3Bh
cmFtcy5oCisrKyBiL3NyYy9wYXJhbXMuaApAQCAtMjEyLDYgKzIxMiwxNiBAQCBzdHJ1Y3Qg
UG9tZHBTb2x2ZVBhcmFtU3RydWN0IHsKICAgICAgbGF0ZXIgcHJ1bmUgb3BlcmF0aW9ucy4g
Ki8KICAgaW50IHVzZV93aXRuZXNzX3BvaW50czsKIAorICAvKiBJZiB0cnVlLCB0aGVuIHRo
ZSBMUCBzb2x2ZXIgZ2VuZXJhdGVzIHJvd3MgaW5jcmVtZW50YWxseSB3aGVuIHNvbHZpbmcK
KyAgICAgdGhlIGZpbmQgcmVnaW9uIExQLgorICAgKi8KKyAgaW50IHVzZV9scF9yb3dnZW47
CisgIAorICAvKiBUaGUgTFAgc29sdmVyIG9ubHkgZ2VuZXJhdGVzIExQIGNvbnN0cmFpbnRz
IGluY3JlbWVudGFsbHkgd2hlbiB0aGUgdG90YWwKKyAgICogbnVtYmVyIG9mIGNvbnN0cmFp
bnRzIGV4Y2VlZHMgdGhlIHRocmVzaG9sZC4KKyAgICovCisgIGludCByb3dnZW5fdGhyZXNo
b2xkOworCiAgIC8qIFRoZSBmaWxlbmFtZSB0byB1c2UgYXMgYSBiYWNrdXAgZmlsZSBmb3Ig
ZWFjaCBpdGVyYXRpb24ncyBhbnN3ZXIuICovCiAgIGNoYXIgYmFja3VwX2ZpbGVbMTAyNF07
CiAKQEAgLTM0NCw2ICszNTQsOCBAQCBzdHJ1Y3QgUG9tZHBTb2x2ZVBhcmFtU3RydWN0IHsK
ICNkZWZpbmUgREVGQVVMVF9VU0VfV0lUTkVTU19QT0lOVFMgICAgICAwCiAjZGVmaW5lIERF
RkFVTFRfUV9QVVJHRV9PUFRJT04gICAgICAgICAgcHVyZ2VfcHJ1bmUKICNkZWZpbmUgREVG
QVVMVF9ET01JTkFUSU9OX0NIRUNLICAgICAgICAxCisjZGVmaW5lIERFRkFVTFRfVVNFX1JP
V0dFTiAgICAgICAgICAgICAgMQorI2RlZmluZSBERUZBVUxUX1JPV0dFTl9USFJFU0hPTEQg
ICAgICAgIDUwCiAKIC8qIE1haW4gZXBzaWxvbiBwYXJhbWV0ZXIgd2hpY2ggbWFueSBvdGhl
ciBlcHNpbG9ucyBuZWVkIHRvIGJlIGRlcml2ZWQKICAgIGZyb20uICovCmRpZmYgLS1naXQg
YS9zcmMvcG9tZHAtc29sdmUtb3B0aW9ucy5jIGIvc3JjL3BvbWRwLXNvbHZlLW9wdGlvbnMu
YwppbmRleCAzNGUwMTc4Li41NDEzNjliIDEwMDY0NAotLS0gYS9zcmMvcG9tZHAtc29sdmUt
b3B0aW9ucy5jCisrKyBiL3NyYy9wb21kcC1zb2x2ZS1vcHRpb25zLmMKQEAgLTE0Niw2ICsx
NDYsOCBAQCBQT01EUF9TT0xWRV9PUFRTX25ldyggKQogICBvcHRpb25zLT5zdGF0X3N1bW1h
cnkgPSBQT01EUF9TT0xWRV9PUFRTX09QVF9TVEFUX1NVTU1BUllfREVGQVVMVDsKICAgb3B0
aW9ucy0+bWF4X3NvbG5fc2l6ZSA9IDAuMDsKICAgb3B0aW9ucy0+dXNlX3dpdG5lc3NfcG9p
bnRzID0gUE9NRFBfU09MVkVfT1BUU19PUFRfV0lUTkVTU19QT0lOVFNfREVGQVVMVDsKKyAg
b3B0aW9ucy0+ZGlzYWJsZV9scF9yb3dnZW4gPSBQT01EUF9TT0xWRV9PUFRTX09QVF9ESVNB
QkxFX1JPV0dFTl9ERUZBVUxUOworICBvcHRpb25zLT5yb3dnZW5fdGhyZXNob2xkID0gUE9N
RFBfU09MVkVfT1BUU19PUFRfUk9XR0VOX1RIUkVTSE9MRF9ERUZBVUxUOwogCiAgIHJldHVy
biggb3B0aW9ucyApOwogCkBAIC0zMDEsNiArMzAzLDEyIEBAIFBPTURQX1NPTFZFX09QVFNf
dG9Db25maWdGaWxlKCBQb21kcFNvbHZlUHJvZ09wdGlvbnMgb3B0aW9ucyApCiAgIHNwcmlu
dGYoIHN0ciwgIiVzIiwgQm9vbGVhbl9TdHJbb3B0aW9ucy0+dXNlX3dpdG5lc3NfcG9pbnRz
XSApOwogICBDRl9hZGRQYXJhbSggY2ZnLCBQT01EUF9TT0xWRV9PUFRTX0NGR19XSVRORVNT
X1BPSU5UU19TVFIsIHN0ciApOwogCisgIHNwcmludGYoIHN0ciwgIiVzIiwgQm9vbGVhbl9T
dHJbb3B0aW9ucy0+ZGlzYWJsZV9scF9yb3dnZW5dICk7CisgIENGX2FkZFBhcmFtKCBjZmcs
IFBPTURQX1NPTFZFX09QVFNfQ0ZHX0RJU0FCTEVfUk9XR0VOX1NUUiwgc3RyICk7CisKKyAg
c3ByaW50Ziggc3RyLCAiJWQiLCBvcHRpb25zLT5yb3dnZW5fdGhyZXNob2xkICk7CisgIENG
X2FkZFBhcmFtKCBjZmcsIFBPTURQX1NPTFZFX09QVFNfQ0ZHX1JPV0dFTl9USFJFU0hPTERf
U1RSLCBzdHIgKTsKKwogICByZXR1cm4gY2ZnOwogCiB9IC8qIFBPTURQX1NPTFZFX09QVFNf
dG9Db25maWdGaWxlICovCkBAIC0zOTUsNiArNDAzLDEwIEBAIFBPTURQX1NPTFZFX09QVFNf
c2hvd1VzYWdlKCBGSUxFKiBmaWxlLCBjaGFyKiBleGVjX25hbWUgKQogICBQT19zaG93VXNh
Z2VFbnVtVHlwZSggZmlsZSwKICAgICAgICAgICAgICAgICAgICAgIFBPTURQX1NPTFZFX09Q
VFNfQVJHX1dJVE5FU1NfUE9JTlRTX1NUUiwKICAgICAgICAgICAgICAgICAgICAgIEJvb2xl
YW5fU3RyICk7CisgIFBPX3Nob3dVc2FnZUVudW1UeXBlKCBmaWxlLAorICAgICAgICAgICAg
ICAgICAgICAgUE9NRFBfU09MVkVfT1BUU19BUkdfRElTQUJMRV9ST1dHRU5fU1RSLAorICAg
ICAgICAgICAgICAgICAgICAgQm9vbGVhbl9TdHIgKTsKKyAgZnByaW50ZiggZmlsZSwgIlx0
JXMgPGludD5cbiIsIFBPTURQX1NPTFZFX09QVFNfQVJHX1JPV0dFTl9USFJFU0hPTERfU1RS
ICk7CiAKICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgIC8qIERlYnVn
IHBhcmFtZXRlcnMgICovCkBAIC04MDgsNiArODIwLDIyIEBAIFBPTURQX1NPTFZFX09QVFNf
cGFyc2UoIFByb2dyYW1PcHRpb25zIG9wdHMgKQogICBpZiAoIHJldF92YWx1ZSA9PSBQT19P
UFRfUFJFU0VOVF9FUlJPUiApCiAgICAgUE9faGFuZGxlRXJyb3IoIG9wdHMsICJPcHRpb24g
J3VzZV93aXRuZXNzX3BvaW50cycgaGFzIGludmFsaWQgdmFsdWUuIiApOwogCisgIHJldF92
YWx1ZSA9IFBPX2dldEludGVnZXJPcHRpb24oIG9wdHMsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICBQT01EUF9TT0xWRV9PUFRTX0FSR19ST1dHRU5fVEhSRVNIT0xEX1NUUiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAmKG9wdGlvbnMtPnJvd2dlbl90aHJlc2hvbGQp
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElOVF9NQVggKTsKKyAgaWYgKCByZXRfdmFsdWUgPT0gUE9fT1BUX1BSRVNFTlRf
RVJST1IgKQorICAgIFBPX2hhbmRsZUVycm9yKCBvcHRzLCAiT3B0aW9uICdyb3dnZW5fdGhy
ZXNob2xkJyBoYXMgaW52YWxpZCB2YWx1ZS4iICk7CisKKyAgcmV0X3ZhbHVlID0gUE9fZ2V0
RW51bU9wdGlvbiggb3B0cywKKyAgICAgICAgICAgICAgICAgICAgICAgICBQT01EUF9TT0xW
RV9PUFRTX0FSR19ESVNBQkxFX1JPV0dFTl9TVFIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgJihlbnVtX2lkeCksCisgICAgICAgICAgICAgICAgICAgICAgICAgQm9vbGVhbl9TdHIg
KTsKKyAgb3B0aW9ucy0+ZGlzYWJsZV9scF9yb3dnZW4gPSBlbnVtX2lkeDsKKyAgaWYgKCBy
ZXRfdmFsdWUgPT0gUE9fT1BUX1BSRVNFTlRfRVJST1IgKQorICAgIFBPX2hhbmRsZUVycm9y
KCBvcHRzLCAiT3B0aW9uICdkaXNhYmxlX2xwX3Jvd2dlbicgaGFzIGludmFsaWQgdmFsdWUu
IiApOworCiAgIFBPX2VuZFZhbGlkYXRlKCBvcHRzICk7CiAKICAgaWYoICEgUE9faXNWYWxp
ZCggb3B0cyApKQpkaWZmIC0tZ2l0IGEvc3JjL3BvbWRwLXNvbHZlLW9wdGlvbnMuaCBiL3Ny
Yy9wb21kcC1zb2x2ZS1vcHRpb25zLmgKaW5kZXggM2M1MzEwYi4uYjI4MzZlZSAxMDA2NDQK
LS0tIGEvc3JjL3BvbWRwLXNvbHZlLW9wdGlvbnMuaAorKysgYi9zcmMvcG9tZHAtc29sdmUt
b3B0aW9ucy5oCkBAIC02NzksNiArNjc5LDE4IEBAIHN0cnVjdCBQb21kcFNvbHZlUHJvZ09w
dGlvbnNTdHJ1Y3QgewogICAgKi8KICAgQm9vbGVhbl9UeXBlIHVzZV93aXRuZXNzX3BvaW50
czsKIAorICAvKgorICAgKiBXaGVuIHVzaW5nIHJvdyBnZW5lcmF0aW9uLCB0aGUgTFAgY29u
c3RyYWludHMgb2YgdGhlIGZpbmQgcmVnaW9uCisgICAqIHBvaW50IExQIGFyZSBhZGRlZCBp
bmNyZW1lbnRhbGx5LiBJZiB0cnVlLCB0aGVuIGl0IGlzIGRpc2FibGVkLgorICAgKi8KKyAg
Qm9vbGVhbl9UeXBlIGRpc2FibGVfbHBfcm93Z2VuOworCisgIC8qCisgICAqIFdoZW4gdXNp
bmcgcm93IGdlbmVyYXRpb24sIHRoZSBhbGdvcml0aG0gb25seSBnZW5lcmF0ZXMgcm93cyBp
bmNyZW1lbnRhbGx5CisgICAqIGlmIHRoZSB0b3RhbCBudW1iZXIgb2YgY29uc3RyYWludHMg
ZXhjZWVkcyB0aGUgdGhyZXNob2xkLgorICAgKi8KKyAgaW50IHJvd2dlbl90aHJlc2hvbGQ7
CisKIH07IC8qIGVuZCBQb21kcFNvbHZlUHJvZ09wdGlvbnNQcm9nT3B0aW9uU3RydWN0ICov
CiAKIC8qCkBAIC03MTEsNiArNzIzLDggQEAgc3RydWN0IFBvbWRwU29sdmVQcm9nT3B0aW9u
c1N0cnVjdCB7CiAjZGVmaW5lIFBPTURQX1NPTFZFX09QVFNfT1BUX1ZJX1ZBUklBVElPTl9E
RUZBVUxUIFBPTURQX1NPTFZFX09QVFNfVmlfVmFyaWF0aW9uX25vcm1hbAogI2RlZmluZSBQ
T01EUF9TT0xWRV9PUFRTX09QVF9TVEFUX1NVTU1BUllfREVGQVVMVCBCb29sZWFuX2ZhbHNl
CiAjZGVmaW5lIFBPTURQX1NPTFZFX09QVFNfT1BUX1dJVE5FU1NfUE9JTlRTX0RFRkFVTFQg
Qm9vbGVhbl9mYWxzZQorI2RlZmluZSBQT01EUF9TT0xWRV9PUFRTX09QVF9ESVNBQkxFX1JP
V0dFTl9ERUZBVUxUIEJvb2xlYW5fZmFsc2UKKyNkZWZpbmUgUE9NRFBfU09MVkVfT1BUU19P
UFRfUk9XR0VOX1RIUkVTSE9MRF9ERUZBVUxUIDUwCiAKIC8qCiAgKiBTdHJpbmdzIGZvciBj
b25maWcgZmlsZSBwYXJhbWV0ZXJzLgpAQCAtNzU5LDYgKzc3Myw4IEBAIHN0cnVjdCBQb21k
cFNvbHZlUHJvZ09wdGlvbnNTdHJ1Y3QgewogI2RlZmluZSBQT01EUF9TT0xWRV9PUFRTX0NG
R19TVEFUX1NVTU1BUllfU1RSICJzdGF0X3N1bW1hcnkiCiAjZGVmaW5lIFBPTURQX1NPTFZF
X09QVFNfQ0ZHX01BWF9TT0xOX1NJWkVfU1RSICJtYXhfc29sbl9zaXplIgogI2RlZmluZSBQ
T01EUF9TT0xWRV9PUFRTX0NGR19XSVRORVNTX1BPSU5UU19TVFIgIndpdG5lc3NfcG9pbnRz
IgorI2RlZmluZSBQT01EUF9TT0xWRV9PUFRTX0NGR19ESVNBQkxFX1JPV0dFTl9TVFIgImRp
c2FibGVfbHBfcm93Z2VuIgorI2RlZmluZSBQT01EUF9TT0xWRV9PUFRTX0NGR19ST1dHRU5f
VEhSRVNIT0xEX1NUUiAibHBfcm93Z2VuX3RocmVzaG9sZCIKIAogLyoKICAqIFN0cmluZ3Mg
Zm9yIGNtZCBsaW5lIHBhcmFtZXRlcnMuCkBAIC04MDcsNiArODIzLDggQEAgc3RydWN0IFBv
bWRwU29sdmVQcm9nT3B0aW9uc1N0cnVjdCB7CiAjZGVmaW5lIFBPTURQX1NPTFZFX09QVFNf
QVJHX1NUQVRfU1VNTUFSWV9TVFIgIi1zdGF0X3N1bW1hcnkiCiAjZGVmaW5lIFBPTURQX1NP
TFZFX09QVFNfQVJHX01BWF9TT0xOX1NJWkVfU1RSICItbWF4X3NvbG5fc2l6ZSIKICNkZWZp
bmUgUE9NRFBfU09MVkVfT1BUU19BUkdfV0lUTkVTU19QT0lOVFNfU1RSICItd2l0bmVzc19w
b2ludHMiCisjZGVmaW5lIFBPTURQX1NPTFZFX09QVFNfQVJHX0RJU0FCTEVfUk9XR0VOX1NU
UiAiLWRpc2FibGVfbHBfcm93Z2VuIgorI2RlZmluZSBQT01EUF9TT0xWRV9PUFRTX0FSR19S
T1dHRU5fVEhSRVNIT0xEX1NUUiAiLWxwX3Jvd2dlbl90aHJlc2hvbGQiCiAKIC8qCiAgKiBT
dHJpbmcgYXJyYXlzIGZvciBjbWQgbGluZSBwYXJhbWV0ZXJzLgpkaWZmIC0tZ2l0IGEvc3Jj
L3JlZ2lvbi5jIGIvc3JjL3JlZ2lvbi5jCmluZGV4IGVmM2ZiNzcuLjEzMjdjZTIgMTAwNjQ0
Ci0tLSBhL3NyYy9yZWdpb24uYworKysgYi9zcmMvcmVnaW9uLmMKQEAgLTYwMiw2ICs2MDIs
NyBAQCBzZXRVcFJlZ2lvbkxQKCBkb3VibGUgKmFscGhhLCBBbHBoYUxpc3QgbGlzdCwgZG91
YmxlIHNwYXJzZV9lcHNpbG9uICkKIAogICBscCA9IExQX25ld0xQKCBudW1fY29uc3RyYWlu
dHMsIG51bV92YXJpYWJsZXMsIG51bV9ub25femVyb2VzICk7CiAgIGxwLT5zcGFyc2VfZXBz
aWxvbiA9IHNwYXJzZV9lcHNpbG9uOworICBscC0+aXNGaW5kUmVnaW9uTFAgPSAxOwogCiAg
IHNldFVwT2JqZWN0aXZlRnVuY3Rpb24oIGxwICk7CiAKZGlmZiAtLWdpdCBhL3NyYy9yZWdp
b24uaCBiL3NyYy9yZWdpb24uaAppbmRleCA4MTVkZmRkLi5kYmNiYWE2IDEwMDY0NAotLS0g
YS9zcmMvcmVnaW9uLmgKKysrIGIvc3JjL3JlZ2lvbi5oCkBAIC01NywxNyArNTcsMjMgQEAK
IC8qIFRoZXJlIGFyZSB0d28gd2F5cyB0byBzZXQgdXAgYSByZWdpb24gTFAuICBUaGUgb3Jp
Z2luYWwgd2F5IGFuZCB0aGUKICAgIHdheSBwcm9wb3NlZCBieSBCb2IgR2l2YW4uICBUaGVy
ZSBpcyBhIGdsb2JhbCBjb25zdGFudCwgd2hlbiBpcyBzZXQKICAgIHdoZW4geW91IHdhbnQg
dG8gdXNlIHRoZSBHaXZhbiBhcHByb2FjaC4gVGhpcyByZXN1bHRzIGluCi0gICBjb25kaXRp
b25hbCBjb21waWxhdGlvbiBvZiBzb21lIHBhcnRzIG9mIGxwLWludGVyZmFjZS5jLiAqLwor
ICAgY29uZGl0aW9uYWwgY29tcGlsYXRpb24gb2Ygc29tZSBwYXJ0cyBvZiBscC1pbnRlcmZh
Y2UuYy4gCiAKLS8qICAjZGVmaW5lIFVTRV9PTERfTFBfRk9STVVMQVRJT04gICovCisgICBX
aGVuIGZpbmQgcmVnaW9uIExQcyBhcmUgc29sdmVkIHVzaW5nIHJvdyBnZW5lcmF0aW9uLCB0
aGVuIGl0IGlzIHJlcXVpcmVkCisgICB0byB1c2UgdGhlICdvbGQnIGZvcm11bGF0aW9uLiAq
LworCisgICAjZGVmaW5lIFVTRV9PTERfTFBfRk9STVVMQVRJT04KIAogCiAvKiBXZSBjYW4g
Y2hvb3NlIGJldHdlZW4gcmVwcmVzZW50aW5nIHRoaW5ncyB1c2luZyB0aGUgc3BhcnNlIExQ
CiAgICByZXByZXNlbnRhdGlvbiBvciBtYWtpbmcgdGhlIHRoaW5nIGRlbnNlLCBhZGRpbmcg
aW4gdGhlIHplcm8KICAgIGVudHJpZXMuIERlZmluaW5nIHRoaXMgdmFyaWFibGUgZm9yY2Vz
IHRoZSB1c2UgZm8gZGVuc2UgTFAKLSAgIHJlcHJlc2VudGF0aW9uLiAqLworICAgcmVwcmVz
ZW50YXRpb24uCisgCisgICBXaGVuIGZpbmQgcmVnaW9uIExQcyBhcmUgc29sdmVkIHVzaW5n
IHJvdyBnZW5lcmF0aW9uLCB0aGVuIGl0IGlzIHJlcXVpcmVkCisgICB0byB1c2UgZGVuc2Ug
TFBzISEhICovCiAKLS8qICAjZGVmaW5lIFVTRV9ERU5TRV9MUFMgICovCisgICAjZGVmaW5l
IFVTRV9ERU5TRV9MUFMKIAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAvKioqKioqKioqKioqKioq
KioqKiogICBERUZBVUxUIFZBTFVFUyAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioq
Ki8KZGlmZiAtLWdpdCBhL3NyYy90d28tcGFzcy5jIGIvc3JjL3R3by1wYXNzLmMKaW5kZXgg
ODcyNDA1NS4uYmQxYWRjMSAxMDA2NDQKLS0tIGEvc3JjL3R3by1wYXNzLmMKKysrIGIvc3Jj
L3R3by1wYXNzLmMKQEAgLTMwMCw2ICszMDAsNyBAQCBzZXRVcFR3b1Bhc3NMcCggQWxwaGFM
aXN0IG5laWdoYm9yLAogCiAgIGxwID0gTFBfbmV3TFAoIG51bV9jb25zdHJhaW50cywgbnVt
X3ZhcmlhYmxlcywgbnVtX25vbl96ZXJvZXMgKTsKICAgbHAtPnNwYXJzZV9lcHNpbG9uID0g
c3BhcnNlX2Vwc2lsb247CisgIGxwLT5pc0ZpbmRSZWdpb25MUCA9IDA7CiAKICAgc2V0VXBU
d29QYXNzTHBPYmplY3RpdmUoIGxwLCBuZWlnaGJvciApOwogICAK
--------------E945A616EC422C18F9D3A4C5--
